[tox]
toworkdir = /data1/DATA/tox/ruamel.yaml 
envlist = cs,py37,py27,py36,py35,py34,pypy,py27m

[testenv]
commands =
    /bin/bash -c 'pytest -ra _test/test_*.py'
deps =
    pytest
    flake8==2.5.5
    ruamel.std.pathlib

[testenv:py27m]
basepython = /opt/python/2.7.15m/bin/python

[testenv:cs]
basepython = python3.6
commands =
    flake8  --exclude .tox,jabsy,jinja2,base,cmd,convert{posargs}

# deprecation warning
[testenv:dw]
basepython = python3.7
commands =
    /bin/bash -c 'pytest _test/test_a*.py _test/test_z*.py'

# deprecation warning fail
[testenv:dwf]
basepython = python3.7
commands =
    /bin/sed 's/collections.abc/collections/' -i .tox/dwf/lib/python3.7/site-packages/ruamel/yaml/comments.py
    /bin/bash -c 'pytest --maxfail=2 _test/test_[a-vz]*.py'

[testenv:pep8]
basepython = python3.6
commands =
    flake8  --exclude .tox,jabsy,jinja2,base,cmd,convert{posargs}

[flake8]
show-source = True
max-line-length = 95
exclude = _test/lib,.hg,.git,.tox,dist,.cache,__pycache__,ruamel.zip2tar.egg-info

[pytest]
filterwarnings =
    error::DeprecationWarning
    error::PendingDeprecationWarning
